{% extends "base.html" %}
{% block title %}Book Appointment{% endblock %}
{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card mt-4 shadow-lg">
            <div class="card-header bg-primary text-white text-center">
                <h3 class="card-title mb-0">Book New Appointment</h3>
            </div>
            <div class="card-body p-4">
                <form method="POST" action="{{ url_for('patient.book_appointment') }}">
                    <div class="form-group mb-3">
                        <label for="doctor_id" class="form-label">Select Doctor <span class="text-danger">*</span></label>
                        <select class="form-control" id="doctor_id" name="doctor_id" required>
                            <option value="">-- Choose a Doctor --</option>
                            {% for doctor in doctors %}
                                <option value="{{ doctor.id }}">{{ doctor.user.full_name | e }} ({{ doctor.specialization | e }})</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group mb-3">
                        <label for="appointment_date" class="form-label">Appointment Date & Time <span class="text-danger">*</span></label>
                        <input type="datetime-local" class="form-control" id="appointment_date" name="appointment_date" required min="{{ 'now' | datetimeformat(format='%Y-%m-%dT%H:%M') }}">
                        <small class="form-text text-muted">Please select a future date and time.</small>
                    </div>
                    <div class="form-group mb-4">
                        <label for="reason" class="form-label">Reason for Appointment</label>
                        <textarea class="form-control" id="reason" name="reason" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg btn-block">Book Appointment</button>
                </form>
                <div class="text-center mt-4">
                    <a href="{{ url_for('patient.view_appointments') }}" class="btn btn-secondary">Back to My Appointments</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script>
    // Custom Jinja2 filter for datetime format (add this to your app.py if not already)
    // In app.py:
    // from datetime import datetime
    // app.jinja_env.filters['datetimeformat'] = lambda value, format='%Y-%m-%d %H:%M:%S': datetime.utcnow().strftime(format) if value == 'now' else value.strftime(format)
</script>
{% endblock %}